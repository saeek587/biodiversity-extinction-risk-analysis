# Assuming total_sp is your data vector of threatened species counts per country
# Save distribution fit histogram
png("visualizations/distribution_fit.png", width=800, height=600)
total_sp <- c(8, 2, 36, 13, 9, 85, 88, 25, 143, 90, 91, 95, 109)
hist(total_sp, breaks=30, col="lightblue", main="Distribution Fit of Threatened Species Counts",
     xlab="Number of Threatened Species", ylab="Frequency")
# Overlay fitted Negative Binomial distribution (example)
fit_nb <- fitdistrplus::fitdist(total_sp, "nbinom")
x_vals <- seq(min(total_sp), max(total_sp), length=100)
y_vals <- dnbinom(x=x_vals, size=fit_nb$estimate["size"], mu=fit_nb$estimate["mu"])
lines(x_vals, y_vals * length(total_sp) * diff(hist(total_sp, plot=FALSE)$breaks)[1], col="red", lwd=2)
legend("topright", legend="Fitted NB Distribution", col="red", lwd=2)
dev.off()
